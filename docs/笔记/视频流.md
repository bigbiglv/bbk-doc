# 流媒体

## 流媒体传输协议
### 播放端
- `HLS`
- `LLHLS`
- `WebRTC`
- `FLV`(已过时ios不支持)

::: tips
传输协议是比播放协议更完整的,播放协议是播放器端用来拉流的格式,传输协议是服务端如何切片播放器如何取切片播放
:::

#### `HLS` (`HTTP Live Streaming`)
- 苹果发明的的流媒体传输协议, 目前全平台可使用
- 一般链接为 `http(s)://xxxx.m3u8`
- 请求一般是先发起一个`.m3u8`的请求,根据内容中的播放列表发起后续的切片请求
- 主流切片格式:
  - `ts`: `MPEG-TS` 
    - 标准响应头`Content-Type`: `application/vnd.apple.mpegurl`或`application/x-mpegURL`
  - `fMP4` `fMP4`
    - 标准响应头`Content-Type`: `video/MP2T`或`video/iso.segment`
- 延迟: 更具切片数量以及大小, 一般一片 `6s` 一个列表 `3~5` 片, 最终 `15~30s`
- `web`播放器: 主流是 `videojs` `hlsjs`

:::tips
只要格式对即使`Content-Type`不是标准的也能根据实际响应的数据播放
:::

#### `LL-HLS` (`Low-Latency HLS`)
- 比 `HLS` 更低延迟的传输协议
- 切分更小,对服务器要求更高
- 环境支持
  - 服务端: `HTTP chunked transfer`
  - 客户端: `partial segment`
- 延迟: 切分更多的数量更小的大小, 最终大概能 `1~3秒`
- `web`播放器: 主流依旧是 `videojs` `hlsjs`

#### `WebRTC` (`Web Real-Time Communication`)
...

### 推流端
- `RTMP`

## 视频编码格式
- 原始视频: 一帧一帧的图像 体积大 不适合存储和传输
- 码流: 通过编码格式(`H.264`)将原始视频**压缩转码**成二进制, 方便传输(文件后缀多为`.h264`)
- 文件: 将码流打包到容器(`MP4`)中方便播放储存 支持多音轨 字幕等
- 主流的编码格式:
- `H.264`
- `H.265`

### `H.264` (`AVC`) 
- 目前主流 兼容性好 硬件解码支持广泛
### `H.265` (`HEVC`)
- 新一代的编码格式 压缩效率更高(对比`h264+50%`) 硬件解码要求高 适合`4k`高分辨率大文件
